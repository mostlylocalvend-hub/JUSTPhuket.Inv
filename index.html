<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>JUST Phuket Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <style>
      .task { position:absolute; top:8px; }
      .btn { border:1px solid rgb(203,213,225); padding:0 6px; border-radius:8px; font-size:12px; line-height:20px; }
    </style>
  </head>
  <body class="bg-slate-50">
    <div id="root"></div>

    <script>
      const React = window.React;
      const ReactDOM = window.ReactDOM;

      // ------- data -------
      const clamp = (n,min,max)=>Math.max(min,Math.min(max,n));
      const rid = ()=>Math.random().toString(36).slice(2,9);
      const WEEKS = [
        { id:"w1", label:"Oct 13" },
        { id:"w2", label:"Oct 20" },
        { id:"w3", label:"Oct 27" },
        { id:"w4", label:"Nov 3"  },
        { id:"w5", label:"Nov 10" }
      ];
      const LANES = [
        { id:"just", name:"JUST (MVP / App Stack)" },
        { id:"safeway", name:"Safeway (Build + Design)" },
        { id:"solstice", name:"Solstice (30D Plan)" },
        { id:"budget", name:"Budget / Calendar / Team" }
      ];
      function sampleLinks(){
        return [
          { type:"Property", label:"Kata Beach Land Plot", url:"https://maps.app.goo.gl/" },
          { type:"Food", label:"Old Town cafés", url:"https://maps.app.goo.gl/" },
          { type:"Modular", label:"Safeway Prefab", url:"https://example.com" },
          { type:"Notion", label:"Faux Task Board", url:"https://notion.so" },
          { type:"LinkedIn", label:"Apichai (Procurement)", url:"https://linkedin.com" }
        ];
      }
      const DEFAULT_TASKS = [
        { id:rid(), laneId:"just", title:"MVP: Verified Hostel Tips", startCol:0, endCol:2, links:sampleLinks() },
        { id:rid(), laneId:"safeway", title:"Buy modules + vendor shortlist", startCol:1, endCol:4, links:sampleLinks() },
        { id:rid(), laneId:"solstice", title:"30-day soft launch plan", startCol:0, endCol:3, links:sampleLinks() },
        { id:rid(), laneId:"budget", title:"Team calendar + hiring", startCol:2, endCol:4, links:sampleLinks() }
      ];

      // ------- app -------
      function App(){
        const gridRef = React.useRef(null);
        const [tasks,setTasks] = React.useState(DEFAULT_TASKS);
        const [selected,setSelected] = React.useState(null);

        const colWidth = ()=> gridRef.current ? gridRef.current.clientWidth / WEEKS.length : 200;

        function addTask(laneId){
          setTasks(p=>[...p,{ id:rid(), laneId, title:"New Task", startCol:0, endCol:0, links:[] }]);
        }
        function delTask(id){
          setTasks(p=>p.filter(t=>t.id!==id));
          if(selected && selected.id===id) setSelected(null);
        }
        function moveTask(id,dir){ // shift by 1 week
          setTasks(p=>p.map(t=>{
            if(t.id!==id) return t;
            const span = t.endCol - t.startCol;
            const ns = clamp(t.startCol + dir, 0, WEEKS.length-1);
            const ne = clamp(ns + span, 0, WEEKS.length-1);
            return {...t, startCol:ns, endCol:ne};
          }));
        }
        function resizeTask(id,side,dir){
          setTasks(p=>p.map(t=>{
            if(t.id!==id) return t;
            if(side==='left'){
              const ns = clamp(t.startCol + dir, 0, t.endCol);
              return {...t, startCol:ns};
            } else {
              const ne = clamp(t.endCol + dir, t.startCol, WEEKS.length-1);
              return {...t, endCol:ne};
            }
          }));
        }

        function Task({task}){
          const w = colWidth();
          const left = task.startCol*w + 8*task.startCol + 4;
          const width= Math.max(w*(task.endCol-task.startCol+1) + 8*(task.endCol-task.startCol), w-6);
          return React.createElement(
            "div",
            { className:"task rounded-2xl border bg-indigo-50/80 px-3 py-2 shadow-sm hover:bg-indigo-100 cursor-pointer",
              style:{left, width}, onClick:()=>setSelected(task) },
            React.createElement("div",{className:"flex items-center gap-2"},
              React.createElement("div",{className:"flex-1 text-sm font-medium truncate"}, task.title),
              React.createElement("button",{className:"btn", onClick:(e)=>{e.stopPropagation();moveTask(task.id,-1);}}, "◀"),
              React.createElement("button",{className:"btn", onClick:(e)=>{e.stopPropagation();moveTask(task.id, 1);}}, "▶"),
              React.createElement("button",{className:"btn", onClick:(e)=>{e.stopPropagation();resizeTask(task.id,'left',-1);}}, "«"),
              React.createElement("button",{className:"btn", onClick:(e)=>{e.stopPropagation();resizeTask(task.id,'right',1);}}, "»"),
              React.createElement("button",{className:"btn", onClick:(e)=>{e.stopPropagation();delTask(task.id);}}, "X")
            )
          );
        }

        return React.createElement(
          "div",
          {className:"min-h-screen text-slate-900"},
          // header
          React.createElement("div",{className:"sticky top-0 z-10 border-b bg-white/70 backdrop-blur"},
            React.createElement("div",{className:"mx-auto max-w-7xl px-4 py-3 flex items-center gap-3"},
              React.createElement("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-2xl bg-indigo-600 text-white font-bold"},"J"),
              React.createElement("div",null,
                React.createElement("div",{className:"text-xl font-semibold"},"JUST Phuket Planner"),
                React.createElement("div",{className:"text-xs text-slate-500"},"Interactive timeline (no build tools)")
              )
            )
          ),
          // weeks
          React.createElement("div",{className:"mx-auto max-w-7xl px-4"},
            React.createElement("div",{className:"grid grid-cols-5 gap-2 pt-4 text-center text-sm font-medium text-slate-600"},
              WEEKS.map(w=>React.createElement("div",{key:w.id,className:"rounded-xl bg-white p-2 shadow-sm"},w.label))
            ),
            // grid
            React.createElement("div",{ref:gridRef,className:"relative mt-2 rounded-2xl border bg-white p-2 shadow-sm"},
              LANES.map((lane)=>React.createElement("div",{key:lane.id},
                React.createElement("div",{className:"flex items-center justify-between px-2 py-2"},
                  React.createElement("div",{className:"text-sm font-semibold"}, lane.name),
                  React.createElement("button",{className:"btn hover:bg-slate-100", onClick:()=>addTask(lane.id)},"+ Add Task")
                ),
                React.createElement("div",{className:"grid grid-cols-5 gap-2 border-b pb-12 pt-2 relative"},
                  [0,1,2,3,4].map(i=>React.createElement("div",{key:i,className:"h-20 rounded-xl bg-slate-50"})),
                  tasks.filter(t=>t.laneId===lane.id).map(t=>React.createElement(Task,{key:t.id, task:t}))
                )
              ))
            )
          ),
          // modal
          selected && React.createElement("div",{className:"fixed inset-0 z-50 bg-black/40 flex items-center justify-center"},
            React.createElement("div",{className:"bg-white w-[420px] max-h-[90vh] overflow-y-auto rounded-2xl p-4 shadow-xl"},
              React.createElement("div",{className:"flex justify-between items-center mb-2"},
                React.createElement("h2",{className:"font-semibold text-sm"}, selected.title),
                React.createElement("button",{className:"btn", onClick:()=>setSelected(null)},"Close")
              ),
              React.createElement("div",{className:"space-y-2"},
                selected.links.map((l,i)=>React.createElement(
                  "a",
                  { key:i, href:l.url, target:"_blank", className:"block rounded-xl border p-2 text-xs hover:bg-slate-50" },
                  React.createElement("b",null,l.type+": "), l.label
                ))
              )
            )
          ),
          React.createElement("div",{className:"mx-auto max-w-7xl px-4 py-6 text-center text-xs text-slate-500"},
            "Click a task for links. Use ◀ ▶ to move, « » to resize, + to add, X to delete."
          )
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(React.createElement(App));
    </script>
  </body>
</html>
