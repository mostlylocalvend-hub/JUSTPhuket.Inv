<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>JUST Phuket Planner</title>
    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React 18 UMD -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Icons (optional, used for + and X) -->
    <script crossorigin src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
      /* simple absolute layout utility (no external libs) */
      .task-card { position:absolute; top:0; }
    </style>
  </head>
  <body class="bg-slate-50">
    <div id="root"></div>

    <script>
      const React = window.React;
      const ReactDOM = window.ReactDOM;
      const lucide = window.lucide;

      // ---- data helpers ----
      const clamp = (n,min,max)=>Math.max(min,Math.min(max,n));
      const rid = ()=>Math.random().toString(36).slice(2,9);

      const WEEKS = [
        { id:"w1", label:"Oct 13" },
        { id:"w2", label:"Oct 20" },
        { id:"w3", label:"Oct 27" },
        { id:"w4", label:"Nov 3"  },
        { id:"w5", label:"Nov 10" }
      ];

      const LANES = [
        { id:"just",    name:"JUST (MVP / App Stack)" },
        { id:"safeway", name:"Safeway (Build + Design)" },
        { id:"solstice",name:"Solstice (30D Plan)" },
        { id:"budget",  name:"Budget / Calendar / Team" }
      ];

      function sampleLinks(){
        return [
          { type:"Property", label:"Kata Beach Land Plot", url:"https://maps.app.goo.gl/" },
          { type:"Food",     label:"Old Town cafés",       url:"https://maps.app.goo.gl/" },
          { type:"Modular",  label:"Safeway Prefab",       url:"https://example.com" },
          { type:"Notion",   label:"Faux Task Board",      url:"https://notion.so" },
          { type:"LinkedIn", label:"Apichai (Procurement)",url:"https://linkedin.com" }
        ];
      }

      const DEFAULT_TASKS = [
        { id:rid(), laneId:"just",    title:"MVP: Verified Hostel Tips",     startCol:0, endCol:2, links:sampleLinks() },
        { id:rid(), laneId:"safeway", title:"Buy modules + vendor shortlist",startCol:1, endCol:4, links:sampleLinks() },
        { id:rid(), laneId:"solstice",title:"30-day soft launch plan",       startCol:0, endCol:3, links:sampleLinks() },
        { id:rid(), laneId:"budget",  title:"Team calendar + hiring",        startCol:2, endCol:4, links:sampleLinks() }
      ];

      // ---- app ----
      function App(){
        const gridRef = React.useRef(null);
        const [tasks,setTasks] = React.useState(DEFAULT_TASKS);
        const [selected,setSelected] = React.useState(null);

        const colWidth = ()=> gridRef.current ? gridRef.current.clientWidth/ WEEKS.length : 200;

        function addTask(laneId){
          setTasks(p=>[...p,{ id:rid(), laneId, title:"New Task", startCol:0, endCol:0, links:sampleLinks() }]);
        }
        function deleteTask(id){
          setTasks(p=>p.filter(t=>t.id!==id));
          if(selected && selected.id===id) setSelected(null);
        }
        function moveTask(id,dir){ // simple left/right shift by 1 column
          setTasks(p=>p.map(t=>{
            if(t.id!==id) return t;
            const len = t.endCol - t.startCol;
            const ns = clamp(t.startCol + dir, 0, WEEKS.length-1);
            const ne = clamp(ns + len, 0, WEEKS.length-1);
            return {...t, startCol:ns, endCol:ne};
          }));
        }
        function resizeTask(id,side,dir){
          setTasks(p=>p.map(t=>{
            if(t.id!==id) return t;
            if(side==='left'){
              const ns = clamp(t.startCol + dir, 0, t.endCol);
              return {...t, startCol:ns};
            } else {
              const ne = clamp(t.endCol + dir, t.startCol, WEEKS.length-1);
              return {...t, endCol:ne};
            }
          }));
        }

        function Task({task, rowIndex}){
          const w = colWidth();
          const left = task.startCol*w + 8*task.startCol + 4;
          const width= Math.max(w*(task.endCol-task.startCol+1) + 8*(task.endCol-task.startCol), w-6);
          const top = 8; // inside the row block
          return React.createElement(
            "div",
            {
              className:"task-card -mt-16 flex items-center gap-2 rounded-2xl border bg-indigo-50/80 px-3 py-2 shadow-sm hover:bg-indigo-100",
              style:{ left, width, top },
              onClick:()=>setSelected(task)
            },
            React.createElement("div",{className:"flex-1 text-sm font-medium"}, task.title),
            React.createElement("div",{className:"flex items-center gap-1"},
              React.createElement("button",{className:"rounded border px-1 text-xs", onClick:(e)=>{e.stopPropagation();moveTask(task.id,-1);}}, "◀"),
              React.createElement("button",{className:"rounded border px-1 text-xs", onClick:(e)=>{e.stopPropagation();moveTask(task.id, 1);}}, "▶"),
              React.createElement("button",{className:"rounded border px-1 text-xs", onClick:(e)=>{e.stopPropagation();resizeTask(task.id,'left',-1);}}, "«"),
              React.createElement("button",{className:"rounded border px-1 text-xs", onClick:(e)=>{e.stopPropagation();resizeTask(task.id,'right',1);}}, "»"),
              React.createElement("button",{className:"rounded-xl p-1 text-slate-500 hover:bg-white", onClick:(e)=>{e.stopPropagation();deleteTask(task.id);}, title:"Delete"},
                React.createElement(lucide.X,{className:"w-4 h-4"})
              )
            )
          );
        }

        return React.createElement(
          "div",
          {className:"min-h-screen text-slate-900"},
          // header
          React.createElement("div",{className:"sticky top-0 z-10 border-b bg-white/70 backdrop-blur"},
            React.createElement("div",{className:"mx-auto max-w-7xl px-4 py-3 flex items-center gap-3"},
              React.createElement("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-2xl bg-indigo-600 text-white font-bold"},"J"),
              React.createElement("div",null,
                React.createElement("div",{className:"text-xl font-semibold"},"JUST Phuket Planner"),
                React.createElement("div",{className:"text-xs text-slate-500"},"Interactive timeline (no build step)")
              )
            )
          ),
          // weeks
          React.createElement("div",{className:"mx-auto max-w-7xl px-4"},
            React.createElement("div",{className:"grid grid-cols-5 gap-2 pt-4 text-center text-sm font-medium text-slate-600"},
              WEEKS.map(w=>React.createElement("div",{key:w.id,className:"rounded-xl bg-white p-2 shadow-sm"},w.label))
            ),
            // grid
            React.createElement("div",{ref:gridRef,className:"relative mt-2 rounded-2xl border bg-white p-2 shadow-sm"},
              LANES.map((lane,ri)=>React.createElement("div",{key:lane.id},
                React.createElement("div",{className:"flex items-center justify-between px-2 py-2"},
                  React.createElement("div",{className:"text-sm font-semibold"}, lane.name),
                  React.createElement("button",{className:"inline-flex items-center gap-1 rounded-xl border px-2 py-1 text-xs hover:bg-slate-100", onClick:()=>addTask(lane.id)},
                    React.createElement(lucide.Plus,{className:"w-3 h-3"}),"Add Task")
                ),
                React.createElement("div",{className:"grid grid-cols-5 gap-2 border-b pb-12 pt-2 relative"},
                  [0,1,2,3,4].map(i=>React.createElement("div",{key:i,className:"h-20 rounded-xl bg-slate-50"})),
                  tasks.filter(t=>t.laneId===lane.id).map(t=>React.createElement(Task,{key:t.id, task:t, rowIndex:ri}))
                )
              ))
            )
          ),
          // modal
          selected && React.createElement("div",{className:"fixed inset-0 z-50 bg-black/40 flex items-center justify-center"},
            React.createElement("div",{className:"bg-white w-[420px] max-h-[90vh] overflow-y-auto rounded-2xl p-4 shadow-xl"},
              React.createElement("div",{className:"flex justify-between items-center mb-2"},
                React.createElement("h2",{className:"font-semibold text-sm"},selected.title),
                React.createElement("button",{className:"rounded-xl border p-1 hover:bg-slate-100", onClick:()=>setSelected(null)},
                  React.createElement(lucide.X,{className:"w-4 h-4"}))
              ),
              React.createElement("div",{className:"space-y-2"},
                selected.links.map((l,i)=>React.createElement("a",{key:i,href:l.url,target:"_blank",className:"block rounded-xl border p-2 text-xs hover:bg-slate-50"},
                  React.createElement("b",null,l.type+": "), l.label))
              )
            )
          ),
          React.createElement("div",{className:"mx-auto max-w-7xl px-4 py-6 text-center text-xs text-slate-500"},
            "Tip: Click a task for links. Use ◀ ▶ to move weeks and « » to resize span."
          )
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(React.createElement(App));
    </script>
  </body>
</html>
